{"version":3,"sources":["scripts/threex-artoolkitsource.js","AR.js","App.js","serviceWorker.js","scripts/threex-artoolkitcontext.js","scripts/threex-arbasecontrols.js","scripts/threex-armarkercontrols.js","index.js"],"names":["window","ARjs","THREEx","Source","ArToolkitSource","parameters","_this","this","ready","domElement","sourceType","sourceUrl","sourceWidth","sourceHeight","displayWidth","displayHeight","undefined","key","newValue","console","warn","setParameters","prototype","init","onReady","onError","_initSourceImage","onSourceReady","_initSourceVideo","_initSourceWebcam","assert","style","position","top","left","zIndex","document","body","appendChild","createElement","src","width","height","interval","setInterval","naturalWidth","clearInterval","objectFit","autoplay","webkitPlaysinline","controls","loop","muted","addEventListener","onClick","removeEventListener","play","videoWidth","error","alert","name","message","fctName","setAttribute","navigator","mediaDevices","enumerateDevices","getUserMedia","then","devices","userMediaConstraints","audio","video","facingMode","ideal","stream","srcObject","catch","domElementWidth","parseInt","domElementHeight","onResizeElement","screenWidth","innerWidth","screenHeight","innerHeight","arguments","length","nodeName","naturalHeight","videoHeight","sourceAspect","screenAspect","newWidth","marginLeft","marginTop","newHeight","copyElementSizeTo","otherElement","copySizeTo","apply","onResize","arToolkitContext","renderer","camera","trackingBackend","isAframe","dataset","aframeCanvas","arController","canvas","arucoContext","setSize","projectionMatrix","copy","getProjectionMatrix","AR","useEffect","robotGltf","mixer","deltaTime","isMounted","clock","Clock","scene","Scene","Camera","WebGLRenderer","antialias","alpha","light","HemisphereLight","arToolkitSource","ArToolkitContext","cameraParametersUrl","process","detectionMode","markerRoot","Group","add","setClearColor","Color","log","ArMarkerControls","type","patternUrl","geometry1","PlaneBufferGeometry","material1","MeshBasicMaterial","color","opacity","mesh1","Mesh","rotation","x","Math","PI","GLTFLoader","load","gltf","scale","set","AnimationMixer","clip","AnimationClip","findByName","animations","clipAction","xhr","loaded","total","initialize","animate","requestAnimationFrame","getDelta","visible","y","update","render","getTracks","forEach","track","stop","removeChild","App","useState","isArEnabled","setArEnabled","className","prevIsArEnabled","Boolean","location","hostname","match","artoolkit","ARController","ARCameraParam","Context","_updatedAt","debug","matrixCodeType","baseURL","maxDetectionRate","canvasWidth","canvasHeight","patternRatio","imageSmoothingEnabled","indexOf","initialized","_arMarkersControls","Object","assign","EventDispatcher","REVISION","createDefaultCamera","onCompleted","_initArtoolkit","dispatchEvent","srcElement","present","performance","now","markerControls","object3d","_updateArtoolkit","addMarker","arMarkerControls","push","removeMarker","index","findIndex","marker","id","splice","_artoolkitProjectionAxisTransformMatrix","Matrix4","multiply","makeRotationY","makeRotationZ","cameraParameters","ctx","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","debugSetup","pointerEvents","AR_TEMPLATE_MATCHING_COLOR","AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX","AR_TEMPLATE_MATCHING_MONO","AR_TEMPLATE_MATCHING_MONO_AND_MATRIX","setPatternDetectionMode","AR_MATRIX_CODE_3x3","AR_MATRIX_CODE_3x3_HAMMING63","AR_MATRIX_CODE_3x3_PARITY65","AR_MATRIX_CODE_4x4","AR_MATRIX_CODE_4x4_BCH_13_9_3","AR_MATRIX_CODE_4x4_BCH_13_5_5","setMatrixCodeType","setPattRatio","projectionMatrixArr","getCameraMatrix","fromArray","ArBaseControls","matrixAutoUpdate","MarkerControls","context","call","size","barcodeValue","changeMatrixMode","minConfidence","create","constructor","dispose","updateWithModelViewMatrix","modelViewMatrix","markerObject3D","tmpMatrix","markerAxisTransformMatrix","makeRotationX","matrix","getInverse","decompose","quaternion","replace","artoolkitMarkerId","delayedInitTimerId","loadMarker","markerId","trackPatternMarkerId","trackBarcodeMarkerId","event","data","PATTERN_MARKER","idPatt","onMarkerFound","BARCODE_MARKER","idMatrix","UNKNOWN_MARKER","postInit","cfPatt","cfMatt","ReactDOM","StrictMode","getElementById","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.6c38e6b1.chunk.js","sourcesContent":["window.ARjs = window.ARjs || {};\nwindow.THREEx = window.THREEx || {};\n\nconst { ARjs, THREEx } = window;\n\nARjs.Source = THREEx.ArToolkitSource = function(parameters){\t\n\tvar _this = this\n\n\tthis.ready = false\n        this.domElement = null\n\n\t// handle default parameters\n\tthis.parameters = {\n\t\t// type of source - ['webcam', 'image', 'video']\n\t\tsourceType : 'webcam',\n\t\t// url of the source - valid if sourceType = image|video\n\t\tsourceUrl : null,\n\t\t\n\t\t// resolution of at which we initialize in the source image\n\t\tsourceWidth: 640,\n\t\tsourceHeight: 480,\n\t\t// resolution displayed for the source \n\t\tdisplayWidth: 640,\n\t\tdisplayHeight: 480,\n\t}\n\t//////////////////////////////////////////////////////////////////////////////\n\t//\t\tsetParameters\n\t//////////////////////////////////////////////////////////////////////////////\n\tsetParameters(parameters)\n\tfunction setParameters(parameters){\n\t\tif( parameters === undefined )\treturn\n\t\tfor( var key in parameters ){\n\t\t\tvar newValue = parameters[ key ]\n\n\t\t\tif( newValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitSource: '\" + key + \"' parameter is undefined.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tvar currentValue = _this.parameters[ key ]\n\n\t\t\tif( currentValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitSource: '\" + key + \"' is not a property of this material.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t_this.parameters[ key ] = newValue\n\t\t}\n\t}\t\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tCode Separator\n//////////////////////////////////////////////////////////////////////////////\nARjs.Source.prototype.init = function(onReady, onError){\n\tvar _this = this\n\tvar domElement;\n\n        if( this.parameters.sourceType === 'image' ){\n                domElement = this._initSourceImage(onSourceReady, onError)                        \n        }else if( this.parameters.sourceType === 'video' ){\n                domElement = this._initSourceVideo(onSourceReady, onError)                        \n        }else if( this.parameters.sourceType === 'webcam' ){\n                domElement = this._initSourceWebcam(onSourceReady, onError)                        \n        }else{\n                console.assert(false)\n        }\n\n\t// attach\n        this.domElement = domElement\n        this.domElement.style.position = 'absolute'\n        this.domElement.style.top = '0px'\n        this.domElement.style.left = '0px'\n        this.domElement.style.zIndex = '-2'\n\n\treturn this\n        function onSourceReady(){\n\t\tdocument.body.appendChild(_this.domElement);\n\n\t\t_this.ready = true\n\n\t\tonReady && onReady()\n        }\n} \n\n////////////////////////////////////////////////////////////////////////////////\n//          init image source\n////////////////////////////////////////////////////////////////////////////////\n\n\nARjs.Source.prototype._initSourceImage = function(onReady) {\n\t// TODO make it static\n        var domElement = document.createElement('img')\n\tdomElement.src = this.parameters.sourceUrl\n\n\tdomElement.width = this.parameters.sourceWidth\n\tdomElement.height = this.parameters.sourceHeight\n\tdomElement.style.width = this.parameters.displayWidth+'px'\n\tdomElement.style.height = this.parameters.displayHeight+'px'\n\n\t// wait until the video stream is ready\n\tvar interval = setInterval(function() {\n\t\tif (!domElement.naturalWidth)\treturn;\n\t\tonReady()\n\t\tclearInterval(interval)\n\t}, 1000/50);\n\n\treturn domElement                \n}\n\n////////////////////////////////////////////////////////////////////////////////\n//          init video source\n////////////////////////////////////////////////////////////////////////////////\n\n\nARjs.Source.prototype._initSourceVideo = function(onReady) {\n\t// TODO make it static\n\tvar domElement = document.createElement('video');\n\tdomElement.src = this.parameters.sourceUrl\n\n\tdomElement.style.objectFit = 'initial'\n\n\tdomElement.autoplay = true;\n\tdomElement.webkitPlaysinline = true;\n\tdomElement.controls = false;\n\tdomElement.loop = true;\n\tdomElement.muted = true\n\n\t// trick to trigger the video on android\n\tdocument.body.addEventListener('click', function onClick(){\n\t\tdocument.body.removeEventListener('click', onClick);\n\t\tdomElement.play()\n\t})\n\n\tdomElement.width = this.parameters.sourceWidth\n\tdomElement.height = this.parameters.sourceHeight\n\tdomElement.style.width = this.parameters.displayWidth+'px'\n\tdomElement.style.height = this.parameters.displayHeight+'px'\n\t\n\t// wait until the video stream is ready\n\tvar interval = setInterval(function() {\n\t\tif (!domElement.videoWidth)\treturn;\n\t\tonReady()\n\t\tclearInterval(interval)\n\t}, 1000/50);\n\treturn domElement\n}\n\n////////////////////////////////////////////////////////////////////////////////\n//          handle webcam source\n////////////////////////////////////////////////////////////////////////////////\n\nARjs.Source.prototype._initSourceWebcam = function(onReady, onError) {\n\tvar _this = this\n\n\t// init default value\n\tonError = onError || function(error){\t\n\t\talert('Webcam Error\\nName: '+error.name + '\\nMessage: '+error.message)\n\t}\n\n\tvar domElement = document.createElement('video');\n\tdomElement.setAttribute('autoplay', '');\n\tdomElement.setAttribute('muted', '');\n\tdomElement.setAttribute('playsinline', '');\n\tdomElement.style.width = this.parameters.displayWidth+'px'\n\tdomElement.style.height = this.parameters.displayHeight+'px'\n\n\tvar fctName;\n\n\t// check API is available\n\tif (navigator.mediaDevices === undefined \n\t\t\t|| navigator.mediaDevices.enumerateDevices === undefined \n\t\t\t|| navigator.mediaDevices.getUserMedia === undefined  ){\n\t\tif( navigator.mediaDevices === undefined )\t\t\t\tfctName = 'navigator.mediaDevices'\n\t\telse if( navigator.mediaDevices.enumerateDevices === undefined )\tfctName = 'navigator.mediaDevices.enumerateDevices'\n\t\telse if( navigator.mediaDevices.getUserMedia === undefined )\t\tfctName = 'navigator.mediaDevices.getUserMedia'\n\t\telse console.assert(false)\n\t\tonError({\n\t\t\tname: '',\n\t\t\tmessage: 'WebRTC issue-! '+fctName+' not present in your browser'\n\t\t})\n\t\treturn null\n\t}\n\n\t// get available devices\n\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n                var userMediaConstraints = {\n\t\t\taudio: false,\n\t\t\tvideo: {\n\t\t\t\tfacingMode: 'environment',\n\t\t\t\twidth: {\n\t\t\t\t\tideal: _this.parameters.sourceWidth,\n\t\t\t\t\t// min: 1024,\n\t\t\t\t\t// max: 1920\n\t\t\t\t},\n\t\t\t\theight: {\n\t\t\t\t\tideal: _this.parameters.sourceHeight,\n\t\t\t\t\t// min: 776,\n\t\t\t\t\t// max: 1080\n\t\t\t\t}\n\t\t  \t}\n                }\n\t\t// get a device which satisfy the constraints\n\t\tnavigator.mediaDevices.getUserMedia(userMediaConstraints).then(function success(stream) {\n\t\t\t// set the .src of the domElement\n\t\t\tdomElement.srcObject = stream;\n\t\t\t// to start the video, when it is possible to start it only on userevent. like in android\n\t\t\tdocument.body.addEventListener('click', function(){\n\t\t\t\tdomElement.play();\n\t\t\t})\n\t\t\t// domElement.play();\n\n// TODO listen to loadedmetadata instead\n\t\t\t// wait until the video stream is ready\n\t\t\tvar interval = setInterval(function() {\n\t\t\t\tif (!domElement.videoWidth)\treturn;\n\t\t\t\tonReady()\n\t\t\t\tclearInterval(interval)\n\t\t\t}, 1000/50);\n\t\t}).catch(function(error) {\n\t\t\tonError({\n\t\t\t\tname: error.name,\n\t\t\t\tmessage: error.message\n\t\t\t});\n\t\t});\n\t}).catch(function(error) {\n\t\tonError({\n\t\t\tmessage: error.message\n\t\t});\n\t});\n\n\treturn domElement\n}\n\nARjs.Source.prototype.domElementWidth = function(){\n\treturn parseInt(this.domElement.style.width)\n}\nARjs.Source.prototype.domElementHeight = function(){\n\treturn parseInt(this.domElement.style.height)\n}\n\n////////////////////////////////////////////////////////////////////////////////\n//          handle resize\n////////////////////////////////////////////////////////////////////////////////\n\nARjs.Source.prototype.onResizeElement = function(){\n\tvar screenWidth = window.innerWidth\n\tvar screenHeight = window.innerHeight\n\n\t// sanity check\n\tconsole.assert( arguments.length === 0 )\n\n\t// compute sourceWidth, sourceHeight\n\tvar sourceWidth;\n\tvar sourceHeight;\n\tif( this.domElement.nodeName === \"IMG\" ){\n\t\tsourceWidth = this.domElement.naturalWidth\n\t\tsourceHeight = this.domElement.naturalHeight\n\t}else if( this.domElement.nodeName === \"VIDEO\" ){\n\t\tsourceWidth = this.domElement.videoWidth\n\t\tsourceHeight = this.domElement.videoHeight\n\t}else{\n\t\tconsole.assert(false)\n\t}\n\t\n\t// compute sourceAspect\n\tvar sourceAspect = sourceWidth / sourceHeight\n\t// compute screenAspect\n\tvar screenAspect = screenWidth / screenHeight\n\n\t// if screenAspect < sourceAspect, then change the width, else change the height\n\tif( screenAspect < sourceAspect ){\n\t\t// compute newWidth and set .width/.marginLeft\n\t\tvar newWidth = sourceAspect * screenHeight\n\t\tthis.domElement.style.width = newWidth+'px'\n\t\tthis.domElement.style.marginLeft = -(newWidth-screenWidth)/2+'px'\n\t\t\n\t\t// init style.height/.marginTop to normal value\n\t\tthis.domElement.style.height = screenHeight+'px'\n\t\tthis.domElement.style.marginTop = '0px'\n\t}else{\n\t\t// compute newHeight and set .height/.marginTop\n\t\tvar newHeight = 1 / (sourceAspect / screenWidth)\n\t\tthis.domElement.style.height = newHeight+'px'\n\t\tthis.domElement.style.marginTop = -(newHeight-screenHeight)/2+'px'\n\t\t\n\t\t// init style.width/.marginLeft to normal value\n\t\tthis.domElement.style.width = screenWidth+'px'\n\t\tthis.domElement.style.marginLeft = '0px'\n\t}\n}\n\nARjs.Source.prototype.copyElementSizeTo = function(otherElement){\n\n\tif (window.innerWidth > window.innerHeight)\n\t{\n\t\t//landscape\n\t\totherElement.style.width = this.domElement.style.width\n\t\totherElement.style.height = this.domElement.style.height\n\t\totherElement.style.marginLeft = this.domElement.style.marginLeft\n\t\totherElement.style.marginTop = this.domElement.style.marginTop\n\t}\n\telse {\n\t\t//portrait\n\t\totherElement.style.height = this.domElement.style.height\n\t\totherElement.style.width = (parseInt(otherElement.style.height) * 4/3)+\"px\";\n\t\totherElement.style.marginLeft = ((window.innerWidth- parseInt(otherElement.style.width))/2)+\"px\";\n\t\totherElement.style.marginTop = 0;\n\t}\n\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tCode Separator\n//////////////////////////////////////////////////////////////////////////////\n\nARjs.Source.prototype.copySizeTo = function(){\n\tconsole.warn('obsolete function arToolkitSource.copySizeTo. Use arToolkitSource.copyElementSizeTo' )\n\tthis.copyElementSizeTo.apply(this, arguments)\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tCode Separator\n//////////////////////////////////////////////////////////////////////////////\n\nARjs.Source.prototype.onResize\t= function(arToolkitContext, renderer, camera){\n\tif( arguments.length !== 3 ){\n\t\tconsole.warn('obsolete function arToolkitSource.onResize. Use arToolkitSource.onResizeElement' )\n\t\treturn this.onResizeElement.apply(this, arguments)\n\t}\n\n\tvar trackingBackend = arToolkitContext.parameters.trackingBackend\n\t\n\n\t// RESIZE DOMELEMENT\n\tif( trackingBackend === 'artoolkit' ){\n\n\t\tthis.onResizeElement()\n\t\t\n\t\tvar isAframe = renderer.domElement.dataset.aframeCanvas ? true : false\n\t\tif( isAframe === false ){\n\t\t\tthis.copyElementSizeTo(renderer.domElement)\t\n\t\t}else{\n\t\t\t\n\t\t}\n\n\t\tif( arToolkitContext.arController !== null ){\n\t\t\tthis.copyElementSizeTo(arToolkitContext.arController.canvas)\t\n\t\t}\n\t}else if( trackingBackend === 'aruco' ){\n\t\tthis.onResizeElement()\n\t\tthis.copyElementSizeTo(renderer.domElement)\t\n\n\t\tthis.copyElementSizeTo(arToolkitContext.arucoContext.canvas)\t\n\t}else if( trackingBackend === 'tango' ){\n\t\trenderer.setSize( window.innerWidth, window.innerHeight )\n\t}else console.assert(false, 'unhandled trackingBackend '+trackingBackend)\n\n\n\t// UPDATE CAMERA\n\tif( trackingBackend === 'artoolkit' ){\n\t\tif( arToolkitContext.arController !== null ){\n\t\t\tcamera.projectionMatrix.copy( arToolkitContext.getProjectionMatrix() );\t\t\t\n\t\t}\n\t}else console.assert(false, 'unhandled trackingBackend '+trackingBackend)\t\n}\n","import React, { useEffect } from 'react';\r\nimport { Scene, Camera, WebGLRenderer, Group, Color, AnimationMixer, AnimationClip, Clock, HemisphereLight, PlaneBufferGeometry, MeshBasicMaterial, Mesh } from 'three';\r\n/* import { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\r\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'; */\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\n\r\n\r\n\r\nfunction AR() {\r\n  useEffect(() => {\r\n    // let fishMesh;\r\n    let robotGltf;\r\n    let mixer;\r\n    let deltaTime = 0;\r\n    let isMounted = true;\r\n    const { THREEx } = window;\r\n    const clock = new Clock();\r\n    const scene = new Scene();\r\n    const camera = new Camera();\r\n    const renderer = new WebGLRenderer({\r\n      antialias: true,\r\n      alpha: true\r\n    });\r\n    const light = new HemisphereLight(0xffffbb, 0x080820, 12);\r\n    // const light = new AmbientLight(0x404040, 15);\r\n    const arToolkitSource = new THREEx.ArToolkitSource({\r\n      sourceType: 'webcam'\r\n    });\r\n    const arToolkitContext = new THREEx.ArToolkitContext({\r\n      cameraParametersUrl: `${process.env.PUBLIC_URL}/data/camera_para.dat`,\r\n      detectionMode: 'mono'\r\n    });\r\n    const markerRoot = new Group();\r\n\r\n    const onResize = () => {\r\n      arToolkitSource.onResizeElement();\r\n      arToolkitSource.copyElementSizeTo(renderer.domElement);\r\n      if (arToolkitContext.arController !== null) {\r\n        arToolkitSource.copyElementSizeTo(arToolkitContext.arController.canvas);\r\n      }\r\n    }\r\n\r\n    const initialize = () => {\r\n      scene.add(light);\r\n      scene.add(camera);\r\n      renderer.setClearColor(new Color('lightgrey'), 0)\r\n      renderer.setSize(640, 480);\r\n      renderer.domElement.style.position = 'absolute';\r\n      renderer.domElement.style.top = '0px';\r\n      renderer.domElement.style.left = '0px';\r\n      console.log(renderer.domElement);\r\n      document.body.appendChild(renderer.domElement);\r\n    \r\n      arToolkitSource.init(onResize);\r\n\r\n      window.addEventListener('resize', onResize);\r\n\r\n      arToolkitContext.init(() => {\r\n        camera.projectionMatrix.copy(arToolkitContext.getProjectionMatrix());\r\n      });\r\n\r\n      scene.add(markerRoot);\r\n      const markerControls = new THREEx.ArMarkerControls(arToolkitContext, markerRoot, {\r\n        type: 'pattern', patternUrl: `${process.env.PUBLIC_URL}/data/hiro.patt`,\r\n      })\r\n\r\n      const geometry1 = new PlaneBufferGeometry(1,1, 4,4);\r\n      const material1 = new MeshBasicMaterial({ color: 0x0033aa, opacity: 0.3 });\r\n      const mesh1 = new Mesh(geometry1, material1);\r\n\r\n      mesh1.rotation.x = -Math.PI/2;\r\n      markerRoot.add(mesh1);\r\n      \r\n      function onProgress(xhr) {\r\n        console.log((xhr.loaded / xhr.total * 100) + '% loaded');\r\n      }\r\n\r\n      function onError(error) {\r\n        console.log('An error happened:', error);\r\n      }\r\n\r\n      \r\n \r\n      /* new MTLLoader()\r\n        .setPath('models/')\r\n        .load('fish-2.mtl',materials => {\r\n          materials.preload();\r\n          new OBJLoader()\r\n            .setMaterials(materials)\r\n            .setPath('models/')\r\n            .load( 'fish-2.obj', group => {\r\n              fishMesh = group.children[0];\r\n\r\n              fishMesh.material.side = DoubleSide;\r\n              fishMesh.position.y = 0.25;\r\n              fishMesh.position.z = 0;\r\n              fishMesh.scale.set(0.2,0.2,0.2);\r\n              markerRoot.add(fishMesh);\r\n\r\n              console.log(markerRoot);\r\n            });\r\n        }); */\r\n\r\n      new GLTFLoader()\r\n        .load(`${process.env.PUBLIC_URL}/models/robot/multiclip.gltf`, gltf => {\r\n          robotGltf = gltf;\r\n\r\n          robotGltf.scene.scale.set(0.005,0.005,0.005);\r\n          markerRoot.add(robotGltf.scene);\r\n\r\n          mixer = new AnimationMixer(robotGltf.scene);\r\n\r\n          const clip = AnimationClip.findByName(robotGltf.animations, 'dance');\r\n          const action = mixer.clipAction(clip);\r\n\r\n          action.play();\r\n\r\n        }, onProgress, onError);\r\n    }\r\n\r\n    const update = () => {\r\n      if (markerRoot.visible) {\r\n        robotGltf.scene.rotation.y += 0.01;\r\n\r\n        if (mixer) {\r\n          mixer.update(deltaTime);\r\n        }\r\n      }\r\n      if (arToolkitSource.ready !== false) {\r\n        arToolkitContext.update(arToolkitSource.domElement);\r\n      }\r\n    };\r\n\r\n    const render = () => {\r\n      renderer.render(scene, camera);\r\n    };\r\n    \r\n    \r\n    const animate = () => {\r\n      if (isMounted) {\r\n        requestAnimationFrame(animate);\r\n        deltaTime = clock.getDelta();\r\n        update();\r\n        render();\r\n      }\r\n    };\r\n\r\n    initialize();\r\n    animate();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      arToolkitSource.domElement.srcObject.getTracks()\r\n        .forEach(track => track.stop());\r\n      document.body.removeChild(arToolkitSource.domElement);\r\n      document.body.removeChild(renderer.domElement);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div />\r\n  );\r\n}\r\n\r\nexport default AR;\r\n","import React, { useState } from 'react';\nimport './App.css';\nimport AR from './AR';\n\nfunction App() {\n  const [isArEnabled, setArEnabled] = useState(false);\n  return (\n    <div className='App'>\n      <button\n        className='App-button'\n        onClick={() => setArEnabled(prevIsArEnabled => !prevIsArEnabled)}\n      >\n        {isArEnabled ? 'Disable' : 'Enable'} AR\n      </button>\n      {isArEnabled &&\n        <AR />\n      }\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { Camera, EventDispatcher, Matrix4 } from 'three';\n\nwindow.ARjs = window.ARjs || {};\nwindow.THREEx = window.THREEx || {};\n\nconst { ARjs, THREEx, artoolkit, ARController, ARCameraParam } = window;\n\nARjs.Context = THREEx.ArToolkitContext = function(parameters){\n\tvar _this = this\n\n\t_this._updatedAt = null\n\n\t// handle default parameters\n\tthis.parameters = {\n\t\t// AR backend - ['artoolkit']\n\t\ttrackingBackend: 'artoolkit',\n\t\t// debug - true if one should display artoolkit debug canvas, false otherwise\n\t\tdebug: false,\n\t\t// the mode of detection - ['color', 'color_and_matrix', 'mono', 'mono_and_matrix']\n\t\tdetectionMode: 'mono',\n\t\t// type of matrix code - valid iif detectionMode end with 'matrix' - [3x3, 3x3_HAMMING63, 3x3_PARITY65, 4x4, 4x4_BCH_13_9_3, 4x4_BCH_13_5_5]\n\t\tmatrixCodeType: '3x3',\n\n\t\t// url of the camera parameters\n\t\tcameraParametersUrl: ARjs.Context.baseURL + 'parameters/camera_para.dat',\n\n\t\t// tune the maximum rate of pose detection in the source image\n\t\tmaxDetectionRate: 60,\n\t\t// resolution of at which we detect pose in the source image\n\t\tcanvasWidth: 640,\n\t\tcanvasHeight: 480,\n\n\t\t// the patternRatio inside the artoolkit marker - artoolkit only\n\t\tpatternRatio: 0.5,\n\n\t\t// enable image smoothing or not for canvas copy - default to true\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/imageSmoothingEnabled\n\t\timageSmoothingEnabled : false,\n\t}\n\t// parameters sanity check\n\tconsole.assert(['artoolkit'].indexOf(this.parameters.trackingBackend) !== -1, 'invalid parameter trackingBackend', this.parameters.trackingBackend)\n\tconsole.assert(['color', 'color_and_matrix', 'mono', 'mono_and_matrix'].indexOf(this.parameters.detectionMode) !== -1, 'invalid parameter detectionMode', this.parameters.detectionMode)\n\n        this.arController = null;\n        this.arucoContext = null;\n\n\t_this.initialized = false\n\n\n\tthis._arMarkersControls = []\n\n\t//////////////////////////////////////////////////////////////////////////////\n\t//\t\tsetParameters\n\t//////////////////////////////////////////////////////////////////////////////\n\tsetParameters(parameters)\n\tfunction setParameters(parameters){\n\t\tif( parameters === undefined )\treturn\n\t\tfor( var key in parameters ){\n\t\t\tvar newValue = parameters[ key ]\n\n\t\t\tif( newValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitContext: '\" + key + \"' parameter is undefined.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tvar currentValue = _this.parameters[ key ]\n\n\t\t\tif( currentValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitContext: '\" + key + \"' is not a property of this material.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t_this.parameters[ key ] = newValue\n\t\t}\n\t}\n}\n\nObject.assign( ARjs.Context.prototype, EventDispatcher.prototype );\n\n// ARjs.Context.baseURL = '../'\n// default to github page\nARjs.Context.baseURL = 'https://jeromeetienne.github.io/AR.js/three.js/'\nARjs.Context.REVISION = '1.6.0'\n\n\n\n/**\n * Create a default camera for this trackingBackend\n * @param {string} trackingBackend - the tracking to user\n * @return {THREE.Camera} the created camera\n */\nARjs.Context.createDefaultCamera = function( trackingBackend ){\n\tconsole.assert(false, 'use ARjs.Utils.createDefaultCamera instead')\n\t// Create a camera\n\tif( trackingBackend === 'artoolkit' ){\n\t\tvar camera = new Camera();\n\t}else console.assert(false)\n\treturn camera\n}\n\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tinit functions\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.init = function(onCompleted){\n\tvar _this = this\n\tif( this.parameters.trackingBackend === 'artoolkit' ){\n\t\tthis._initArtoolkit(done)\n\t}else console.assert(false)\n\treturn\n\n\tfunction done(){\n\t\t// dispatch event\n\t\t_this.dispatchEvent({\n\t\t\ttype: 'initialized'\n\t\t});\n\n\t\t_this.initialized = true\n\n\t\tonCompleted && onCompleted()\n\t}\n\n}\n////////////////////////////////////////////////////////////////////////////////\n//          update function\n////////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.update = function(srcElement){\n\n\t// be sure arController is fully initialized\n        if(this.parameters.trackingBackend === 'artoolkit' && this.arController === null) return false;\n\n\t// honor this.parameters.maxDetectionRate\n\tvar present = performance.now()\n\tif( this._updatedAt !== null && present - this._updatedAt < 1000/this.parameters.maxDetectionRate ){\n\t\treturn false\n\t}\n\tthis._updatedAt = present\n\n\t// mark all markers to invisible before processing this frame\n\tthis._arMarkersControls.forEach(function(markerControls){\n\t\tmarkerControls.object3d.visible = false\n\t})\n\n\t// process this frame\n\tif(this.parameters.trackingBackend === 'artoolkit'){\n\t\tthis._updateArtoolkit(srcElement)\n\t} else {\n\t\tconsole.assert(false)\n\t}\n\n\t// dispatch event\n\tthis.dispatchEvent({\n\t\ttype: 'sourceProcessed'\n\t});\n\n\n\t// return true as we processed the frame\n\treturn true;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n//          Add/Remove markerControls\n////////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.addMarker = function(arMarkerControls){\n\tconsole.assert(arMarkerControls instanceof THREEx.ArMarkerControls)\n\tthis._arMarkersControls.push(arMarkerControls)\n}\n\nARjs.Context.prototype.removeMarker = function(arMarkerControls){\n\tconsole.assert(arMarkerControls instanceof THREEx.ArMarkerControls);\n\tconst index = this._arMarkersControls.findIndex(marker => marker.id === arMarkerControls.id);\n\tthis._arMarkersControls.splice(index, 1);\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tartoolkit specific\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype._initArtoolkit = function(onCompleted){\n        var _this = this\n\n\t// set this._artoolkitProjectionAxisTransformMatrix to change artoolkit projection matrix axis to match usual webgl one\n\tthis._artoolkitProjectionAxisTransformMatrix = new Matrix4()\n\tthis._artoolkitProjectionAxisTransformMatrix.multiply(new Matrix4().makeRotationY(Math.PI))\n\tthis._artoolkitProjectionAxisTransformMatrix.multiply(new Matrix4().makeRotationZ(Math.PI))\n\n\t// get cameraParameters\n        var cameraParameters = new ARCameraParam(_this.parameters.cameraParametersUrl, function(){\n        \t// init controller\n                var arController = new ARController(_this.parameters.canvasWidth, _this.parameters.canvasHeight, cameraParameters);\n                _this.arController = arController\n\n\t\t// honor this.parameters.imageSmoothingEnabled\n\t\tarController.ctx.mozImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.webkitImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.msImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.imageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\n\t\t// honor this.parameters.debug\n                if( _this.parameters.debug === true ){\n\t\t\tarController.debugSetup();\n\t\t\tarController.canvas.style.position = 'absolute'\n\t\t\tarController.canvas.style.top = '0px'\n\t\t\tarController.canvas.style.opacity = '0.6'\n\t\t\tarController.canvas.style.pointerEvents = 'none'\n\t\t\tarController.canvas.style.zIndex = '-1'\n\t\t}\n\n\t\t// setPatternDetectionMode\n\t\tvar detectionModes = {\n\t\t\t'color'\t\t\t: artoolkit.AR_TEMPLATE_MATCHING_COLOR,\n\t\t\t'color_and_matrix'\t: artoolkit.AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX,\n\t\t\t'mono'\t\t\t: artoolkit.AR_TEMPLATE_MATCHING_MONO,\n\t\t\t'mono_and_matrix'\t: artoolkit.AR_TEMPLATE_MATCHING_MONO_AND_MATRIX,\n\t\t}\n\t\tvar detectionMode = detectionModes[_this.parameters.detectionMode]\n\t\tconsole.assert(detectionMode !== undefined)\n\t\tarController.setPatternDetectionMode(detectionMode);\n\n\t\t// setMatrixCodeType\n\t\tvar matrixCodeTypes = {\n\t\t\t'3x3'\t\t: artoolkit.AR_MATRIX_CODE_3x3,\n\t\t\t'3x3_HAMMING63'\t: artoolkit.AR_MATRIX_CODE_3x3_HAMMING63,\n\t\t\t'3x3_PARITY65'\t: artoolkit.AR_MATRIX_CODE_3x3_PARITY65,\n\t\t\t'4x4'\t\t: artoolkit.AR_MATRIX_CODE_4x4,\n\t\t\t'4x4_BCH_13_9_3': artoolkit.AR_MATRIX_CODE_4x4_BCH_13_9_3,\n\t\t\t'4x4_BCH_13_5_5': artoolkit.AR_MATRIX_CODE_4x4_BCH_13_5_5,\n\t\t}\n\t\tvar matrixCodeType = matrixCodeTypes[_this.parameters.matrixCodeType]\n\t\tconsole.assert(matrixCodeType !== undefined)\n\t\tarController.setMatrixCodeType(matrixCodeType);\n\n\t\t// set the patternRatio for artoolkit\n\t\tarController.setPattRatio(_this.parameters.patternRatio);\n\n\t\t// set thresholding in artoolkit\n\t\t// this seems to be the default\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_MANUAL)\n\t\t// adatative consume a LOT of cpu...\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_AUTO_ADAPTIVE)\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_AUTO_OTSU)\n\n\t\t// notify\n                onCompleted()\n        })\n\treturn this\n}\n\n/**\n * return the projection matrix\n */\nARjs.Context.prototype.getProjectionMatrix = function(srcElement){\n\n\n// FIXME rename this function to say it is artoolkit specific - getArtoolkitProjectMatrix\n// keep a backward compatibility with a console.warn\n\n\tconsole.assert( this.parameters.trackingBackend === 'artoolkit' )\n\tconsole.assert(this.arController, 'arController MUST be initialized to call this function')\n\t// get projectionMatrixArr from artoolkit\n\tvar projectionMatrixArr = this.arController.getCameraMatrix();\n\tvar projectionMatrix = new Matrix4().fromArray(projectionMatrixArr)\n\n\t// apply context._axisTransformMatrix - change artoolkit axis to match usual webgl one\n\tprojectionMatrix.multiply(this._artoolkitProjectionAxisTransformMatrix)\n\n\t// return the result\n\treturn projectionMatrix\n}\n\nARjs.Context.prototype._updateArtoolkit = function(srcElement){\n\tthis.arController.process(srcElement)\n}\n","import { EventDispatcher } from 'three';\n\nwindow.THREEx = window.THREEx || {};\n\nconst { THREEx } = window;\n\nTHREEx.ArBaseControls = function(object3d){\n\tthis.id = THREEx.ArBaseControls.id++\n\n\tthis.object3d = object3d\n\tthis.object3d.matrixAutoUpdate = false;\n\tthis.object3d.visible = false\n\n\t// Events to honor\n\t// this.dispatchEvent({ type: 'becameVisible' })\n\t// this.dispatchEvent({ type: 'markerVisible' })\t// replace markerFound\n\t// this.dispatchEvent({ type: 'becameUnVisible' })\n}\n\nTHREEx.ArBaseControls.id = 0\n\nObject.assign(THREEx.ArBaseControls.prototype, EventDispatcher.prototype);\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tFunctions\n//////////////////////////////////////////////////////////////////////////////\n/**\n * error catching function for update()\n */\nTHREEx.ArBaseControls.prototype.update = function(){\n\tconsole.assert(false, 'you need to implement your own update')\n}\n\n/**\n * error catching function for name()\n */\nTHREEx.ArBaseControls.prototype.name = function(){\n\tconsole.assert(false, 'you need to implement your own .name()')\n\treturn 'Not yet implemented - name()'\n}\n","import { Matrix4 } from 'three';\n\nwindow.ARjs = window.ARjs || {};\nwindow.THREEx = window.THREEx || {};\n\nconst { artoolkit, ARjs, THREEx } = window;\n\n\nARjs.MarkerControls = THREEx.ArMarkerControls = function(context, object3d, parameters){\n\tvar _this = this\n\n\tTHREEx.ArBaseControls.call(this, object3d)\n\n\tthis.context = context\n\t// handle default parameters\n\tthis.parameters = {\n\t\t// size of the marker in meter\n\t\tsize : 1,\n\t\t// type of marker - ['pattern', 'barcode', 'unknown' ]\n\t\ttype : 'unknown',\n\t\t// url of the pattern - IIF type='pattern'\n\t\tpatternUrl : null,\n\t\t// value of the barcode - IIF type='barcode'\n\t\tbarcodeValue : null,\n\t\t// change matrix mode - [modelViewMatrix, cameraTransformMatrix]\n\t\tchangeMatrixMode : 'modelViewMatrix',\n\t\t// minimal confidence in the marke recognition - between [0, 1] - default to 1\n\t\tminConfidence: 0.6,\n\t}\n\n\t// sanity check\n\tvar possibleTypeValues = ['pattern', 'barcode', 'unknown']\n\tconsole.assert(possibleTypeValues.indexOf(this.parameters.type) !== -1, 'illegal value', this.parameters.type)\n\tvar possibleMatrixModeValues = ['modelViewMatrix', 'cameraTransformMatrix' ]\n\tconsole.assert(possibleMatrixModeValues.indexOf(this.parameters.changeMatrixMode) !== -1, 'illegal value', this.parameters.changeMatrixMode)\n\n\n        // create the marker Root\n\tthis.object3d = object3d\n\tthis.object3d.matrixAutoUpdate = false;\n\tthis.object3d.visible = false\n\n\t//////////////////////////////////////////////////////////////////////////////\n\t//\t\tsetParameters\n\t//////////////////////////////////////////////////////////////////////////////\n\tsetParameters(parameters)\n\tfunction setParameters(parameters){\n\t\tif( parameters === undefined )\treturn\n\t\tfor( var key in parameters ){\n\t\t\tvar newValue = parameters[ key ]\n\n\t\t\tif( newValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArMarkerControls: '\" + key + \"' parameter is undefined.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tvar currentValue = _this.parameters[ key ]\n\n\t\t\tif( currentValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArMarkerControls: '\" + key + \"' is not a property of this material.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t_this.parameters[ key ] = newValue\n\t\t}\n\t}\n\n\t//////////////////////////////////////////////////////////////////////////////\n\t//\t\tCode Separator\n\t//////////////////////////////////////////////////////////////////////////////\n\t// add this marker to artoolkitsystem\n\t// TODO rename that .addMarkerControls\n\tcontext.addMarker(this)\n\n\tif( _this.context.parameters.trackingBackend === 'artoolkit' ){\n\t\tthis._initArtoolkit()\n\t}else console.assert(false)\n}\n\nARjs.MarkerControls.prototype = Object.create( THREEx.ArBaseControls.prototype );\nARjs.MarkerControls.prototype.constructor = THREEx.ArMarkerControls;\n\nARjs.MarkerControls.prototype.dispose = function(){\n\tthis.context.removeMarker(this)\n\n\t// TODO remove the event listener if needed\n\t// unloadMaker ???\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tupdate controls with new modelViewMatrix\n//////////////////////////////////////////////////////////////////////////////\n\n/**\n * When you actually got a new modelViewMatrix, you need to perfom a whole bunch\n * of things. it is done here.\n */\nARjs.MarkerControls.prototype.updateWithModelViewMatrix = function(modelViewMatrix){\n\tvar markerObject3D = this.object3d;\n\n\t// mark object as visible\n\tmarkerObject3D.visible = true\n\n\tif( this.context.parameters.trackingBackend === 'artoolkit' ){\n\t\t// apply context._axisTransformMatrix - change artoolkit axis to match usual webgl one\n\t\tvar tmpMatrix = new Matrix4().copy(this.context._artoolkitProjectionAxisTransformMatrix)\n\t\ttmpMatrix.multiply(modelViewMatrix)\n\n\t\tmodelViewMatrix.copy(tmpMatrix)\n\t}\n\n\tif( this.context.parameters.trackingBackend !== 'tango' ){\n\t\t// change axis orientation on marker - artoolkit say Z is normal to the marker - ar.js say Y is normal to the marker\n\t\tvar markerAxisTransformMatrix = new Matrix4().makeRotationX(Math.PI/2)\n\t\tmodelViewMatrix.multiply(markerAxisTransformMatrix)\n\t}\n\n\t// change markerObject3D.matrix based on parameters.changeMatrixMode\n\tif( this.parameters.changeMatrixMode === 'modelViewMatrix' ){\n\t\tmarkerObject3D.matrix.copy(modelViewMatrix)\n\t}else if( this.parameters.changeMatrixMode === 'cameraTransformMatrix' ){\n\t\tmarkerObject3D.matrix.getInverse( modelViewMatrix )\n\t}else {\n\t\tconsole.assert(false)\n\t}\n\n\t// decompose - the matrix into .position, .quaternion, .scale\n\tmarkerObject3D.matrix.decompose(markerObject3D.position, markerObject3D.quaternion, markerObject3D.scale)\n\n\t// dispatchEvent\n\tthis.dispatchEvent( { type: 'markerFound' } );\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tutility functions\n//////////////////////////////////////////////////////////////////////////////\n\n/**\n * provide a name for a marker\n * - silly heuristic for now\n * - should be improved\n */\nARjs.MarkerControls.prototype.name = function(){\n\tvar name = ''\n\tname += this.parameters.type;\n\tif( this.parameters.type === 'pattern' ){\n\t\tvar url = this.parameters.patternUrl\n\t\tvar basename = url.replace(/^.*\\//g, '')\n\t\tname += ' - ' + basename\n\t}else if( this.parameters.type === 'barcode' ){\n\t\tname += ' - ' + this.parameters.barcodeValue\n\t}else{\n\t\tconsole.assert(false, 'no .name() implemented for this marker controls')\n\t}\n\treturn name\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tinit for Artoolkit\n//////////////////////////////////////////////////////////////////////////////\nARjs.MarkerControls.prototype._initArtoolkit = function(){\n\tvar _this = this\n\n\tvar artoolkitMarkerId = null\n\n\tvar delayedInitTimerId = setInterval(function(){\n\t\t// check if arController is init\n\t\tvar arController = _this.context.arController\n\t\tif( arController === null )\treturn\n\t\t// stop looping if it is init\n\t\tclearInterval(delayedInitTimerId)\n\t\tdelayedInitTimerId = null\n\t\t// launch the _postInitArtoolkit\n\t\tpostInit()\n\t}, 1000/50)\n\n\treturn\n\n\tfunction postInit(){\n\t\t// check if arController is init\n\t\tvar arController = _this.context.arController\n\t\tconsole.assert(arController !== null )\n\n\t\t// start tracking this pattern\n\t\tif( _this.parameters.type === 'pattern' ){\n\t                arController.loadMarker(_this.parameters.patternUrl, function(markerId) {\n\t\t\t\tartoolkitMarkerId = markerId\n\t                        arController.trackPatternMarkerId(artoolkitMarkerId, _this.parameters.size);\n\t                });\n\t\t}else if( _this.parameters.type === 'barcode' ){\n\t\t\tartoolkitMarkerId = _this.parameters.barcodeValue\n\t\t\tarController.trackBarcodeMarkerId(artoolkitMarkerId, _this.parameters.size);\n\t\t}else if( _this.parameters.type === 'unknown' ){\n\t\t\tartoolkitMarkerId = null\n\t\t}else{\n\t\t\tconsole.log(false, 'invalid marker type', _this.parameters.type)\n\t\t}\n\n\t\t// listen to the event\n\t\tarController.addEventListener('getMarker', function(event){\n\t\t\tif( event.data.type === artoolkit.PATTERN_MARKER && _this.parameters.type === 'pattern' ){\n\t\t\t\tif( artoolkitMarkerId === null )\treturn\n\t\t\t\tif( event.data.marker.idPatt === artoolkitMarkerId ) onMarkerFound(event)\n\t\t\t}else if( event.data.type === artoolkit.BARCODE_MARKER && _this.parameters.type === 'barcode' ){\n\t\t\t\t// console.log('BARCODE_MARKER idMatrix', event.data.marker.idMatrix, artoolkitMarkerId )\n\t\t\t\tif( artoolkitMarkerId === null )\treturn\n\t\t\t\tif( event.data.marker.idMatrix === artoolkitMarkerId )  onMarkerFound(event)\n\t\t\t}else if( event.data.type === artoolkit.UNKNOWN_MARKER && _this.parameters.type === 'unknown'){\n\t\t\t\tonMarkerFound(event)\n\t\t\t}\n\t\t})\n\n\t}\n\n\tfunction onMarkerFound(event){\n\t\t// honor his.parameters.minConfidence\n\t\tif( event.data.type === artoolkit.PATTERN_MARKER && event.data.marker.cfPatt < _this.parameters.minConfidence )\treturn\n\t\tif( event.data.type === artoolkit.BARCODE_MARKER && event.data.marker.cfMatt < _this.parameters.minConfidence )\treturn\n\n\t\tvar modelViewMatrix = new Matrix4().fromArray(event.data.matrix)\n\t\t_this.updateWithModelViewMatrix(modelViewMatrix)\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport './scripts/threex-artoolkitsource.js';\nimport './scripts/threex-artoolkitcontext.js';\nimport './scripts/threex-arbasecontrols.js';\nimport './scripts/threex-armarkercontrols.js';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}