(this["webpackJsonpar-test"]=this["webpackJsonpar-test"]||[]).push([[0],{14:function(e,t,r){e.exports=r(32)},19:function(e,t,r){},29:function(e,t,r){},30:function(e,t,r){},31:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),o=r(5),i=r.n(o),s=r(3),c=r(10),l=r.n(c),d=r(0),m=r(11),u=r(12),p=r.n(u),h=(r(19),function(e){var t=e.width,r=e.height,a=e.style,o=e.fillColor,i=e.isActive,s=e.className;return n.a.createElement("svg",{style:a,width:t,height:r,"aria-hidden":"true",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",className:p()(s,i&&"sound-wave--active")},n.a.createElement("g",{fill:o},n.a.createElement("rect",{className:"sound-wave-bar sound-wave-bar-1",x:"4.9",rx:"1.5"}),n.a.createElement("rect",{className:"sound-wave-bar sound-wave-bar-2",x:"13.5",rx:"1.5"}),n.a.createElement("rect",{className:"sound-wave-bar sound-wave-bar-3",x:"22.1",rx:"1.5"}),n.a.createElement("rect",{className:"sound-wave-bar sound-wave-bar-2",x:"30.7",rx:"1.5"}),n.a.createElement("rect",{className:"sound-wave-bar sound-wave-bar-1",x:"39.5",rx:"1.5"})))});h.defaultProps={width:"24",height:"24",fillColor:"#fff"};var f=h,v=function(e){var t=e.width,r=e.height,a=e.style,o=e.strokeColor,i=e.isMute;return n.a.createElement("svg",{style:a,width:t,height:r,"aria-hidden":"true",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("g",{transform:"translate(1, 3)",stroke:o,strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},n.a.createElement("path",{d:"M5.57,6.06 L1.25,6.06 C0.84,6.06 0.5,6.4 0.5,6.8 L0.5,11.36 C0.5,11.78 0.84,12.12 1.25,12.12 L5.57,12.12 C6.7,15.03 9.34,17.06 12.43,17.38 C12.64,17.4 12.85,17.33 13,17.18 C13.16,17.04 13.25,16.84 13.25,16.62 L13.25,1.55 C13.25,1.34 13.16,1.13 13,1 C12.85,0.85 12.64,0.78 12.43,0.8 C9.34,1.11 6.7,3.15 5.57,6.06 Z"}),i?n.a.createElement(n.a.Fragment,null,n.a.createElement("line",{x1:"21.32",y1:"7",x2:"17",y2:"11.5"}),n.a.createElement("line",{x1:"17",y1:"7",x2:"21.32",y2:"11.5"})):n.a.createElement(n.a.Fragment,null,n.a.createElement("path",{d:"M20.46,12.67 C21.85,10.49 21.85,7.69 20.46,5.5"}),n.a.createElement("path",{d:"M17.56,11.357 C18.6,10.06 18.6,8.2 17.56,6.9"}))))};v.defaultProps={width:"24",height:"24",strokeColor:"#fff"};var E=v,x=r(4),y=r(13),w=r.n(y),g=function(){var e=function(){return{width:window.innerWidth,height:window.innerHeight}},t=Object(a.useState)(e),r=Object(s.a)(t,2),n=r[0],o=r[1];return Object(a.useEffect)((function(){var t=w()((function(){o(e())}),50);return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]),n},A=function(e,t){var r=g(),a=r.width,n=r.height;if(!e)return{width:a,height:n,marginTop:0,marginLeft:0};var o=t.current.videoWidth/t.current.videoHeight;if(a/n<o){var i=o*n;return{height:n,width:i,marginTop:0,marginLeft:-(i-a)/2}}var s=1/(o/a);return{width:a,height:s,marginTop:-(s-n)/2,marginLeft:0}},M=function(e){var t=e.sourceWidth,r=e.sourceHeight,i=e.canvasRef,c=e.videoSourceRef,l=Object(a.useRef)(),d=Object(a.useState)(!1),m=Object(s.a)(d,2),u=m[0],p=m[1],h=A(u,l);return console.log(h),Object(a.useEffect)((function(){var e=!0,a=function(){l.current.play()},n={audio:!1,video:{facingMode:"environment",width:{ideal:t,min:640,max:1920},height:{ideal:r,min:480,max:1080}}};return navigator.mediaDevices.getUserMedia(n).then((function(t){if(e){l.current.srcObject=t,document.body.addEventListener("click",a);var r=setInterval((function(){l.current&&l.current.videoWidth&&(p(!0),clearInterval(r))}),20)}})),function(){e=!1,document.body.removeEventListener("click",a)}}),[t,r]),Object(o.createPortal)(n.a.createElement(n.a.Fragment,null,n.a.createElement("video",{muted:!0,autoPlay:!0,playsInline:!0,ref:function(e){l.current=e,c.current=e},style:h}),n.a.createElement("canvas",{ref:i,style:Object(x.a)({position:"absolute",top:0,left:0},h)})),document.getElementById("ar-container"))};M.defaultProps={sourceWidth:640,sourceHeight:480,canvasRef:{},videoSourceRef:{}};var b=M,C=(r(29),function(e){var t=e.initialScale,r=e.patternUrl,o=e.cameraParametersUrl,i=e.modelUrl,c=e.audioUrl,u=Object(a.useRef)(),p=Object(a.useRef)(),h=Object(a.useRef)(),v=Object(a.useRef)(),x=Object(a.useRef)(),y=Object(a.useRef)(),w=Object(a.useRef)({eventRotation:0,modelRotation:0}),g=Object(a.useState)(!1),A=Object(s.a)(g,2),M=A[0],C=A[1],_=Object(a.useState)(!1),k=Object(s.a)(_,2),R=k[0],T=k[1];return Object(a.useEffect)((function(){R?u.current.play():u.current.pause()}),[R]),Object(a.useEffect)((function(){var e=t/3,r=3*t;return h.current=new l.a(document.getElementById("ar-container")),h.current.get("pan").set({enable:!1}),h.current.get("pinch").set({enable:!0}),h.current.get("rotate").set({enable:!0}),h.current.on("pinchstart",(function(e){p.current&&(y.current=p.current.scene.scale.x)})),h.current.on("pinch",(function(t){if(y.current&&p.current){var a=y.current*t.scale,n=Math.min(Math.max(a,e),r);p.current.scene.scale.set(n,n,n)}})),h.current.on("rotatestart",(function(e){p.current&&(w.current={modelRotation:p.current.scene.rotation.y,eventRotation:e.rotation})})),h.current.on("rotate",(function(e){if(p.current){var t=(e.rotation-w.current.eventRotation)/180*Math.PI;p.current.scene.rotation.y=w.current.modelRotation-t}})),function(){h.current.destroy()}}),[t]),Object(a.useEffect)((function(){var e,a,n=0,s=!0,c=!1,l=640,u=480,h=window.THREEx,f=h.ArToolkitContext,E=h.ArMarkerControls,y=new d.cb,w=new d.j,g=new d.h,A=new d.ob({canvas:v.current,antialias:!0,alpha:!0}),M=new f({cameraParametersUrl:o,detectionMode:"mono",canvasWidth:l,canvasHeight:u}),b=new d.q;y.add(g),A.setClearColor(new d.k("lightgrey"),0),A.setPixelRatio(window.devicePixelRatio),M.init((function(){g.projectionMatrix.copy(M.getProjectionMatrix())})),new E(M,b,{type:"pattern",patternUrl:r}),(new m.a).load(i,(function(r){p.current=r;var n=r.scene;n.scale.set(t,t,t);var o=new d.a(16777215,1);b.add(o);var i=new d.U(16777215,1,0,2);i.position.set(0,1,1),b.add(i);var s=new d.U(16777215,1,0,2);s.position.set(0,1,-1),b.add(s),b.add(n),e=new d.c(n);var l=r.animations[0];(a=e.clipAction(l)).play(),a.paused=!c,y.add(b)}));return function t(){s&&(requestAnimationFrame(t),n=w.getDelta(),c!==b.visible&&(c=b.visible,T(b.visible),a&&(a.paused=!c)),e&&e.update(n),x.current&&M.update(x.current),A.render(y,g))}(),function(){s=!1}}),[t,o,r,i]),n.a.createElement("div",null,n.a.createElement(b,{canvasRef:v,videoSourceRef:x}),n.a.createElement("div",{className:"ar-icons-overlay"}),n.a.createElement("audio",{loop:!0,ref:u,preload:"auto"},n.a.createElement("source",{src:c,type:"audio/mpeg"})),n.a.createElement("button",{className:"ar-icon ar-icon-sound",onClick:function(){C(!M),u.current.volume=M?1:0}},n.a.createElement(E,{width:32,height:32,isMute:M})),n.a.createElement(f,{width:32,height:32,isActive:R,className:"ar-icon ar-icon-wave"}))});C.defaultProps={initialScale:5e-4,audioUrl:"".concat("/ar-test","/audio/anchor.mp3"),modelUrl:"".concat("/ar-test","/models/anchor/MiraiKoukai7.gltf"),patternUrl:"".concat("/ar-test","/data/hiro.patt"),cameraParametersUrl:"".concat("/ar-test","/data/camera_para.dat")};var _=C;r(30);var k=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),r=t[0],o=t[1];return n.a.createElement("div",{className:"App"},n.a.createElement("button",{className:"App-button",onClick:function(){return o((function(e){return!e}))}},r?"Disable":"Enable"," AR"),r&&n.a.createElement(_,null))};window.THREEx=window.THREEx||{};var R=window.THREEx;R.ArToolkitSource=function(e){this.ready=!1,this.domElement=null,this.parameters=Object(x.a)({sourceWidth:640,sourceHeight:480,displayWidth:640,displayHeight:480},e)},R.ArToolkitSource.prototype.dispose=function(){document.getElementById("ar-container").removeChild(this.domElement)},R.ArToolkitSource.prototype.init=function(e,t){var r=this;return this.domElement=this._initSourceWebcam((function(){document.getElementById("ar-container").appendChild(r.domElement),r.ready=!0,e&&e()}),t),this.domElement.style.position="absolute",this.domElement.style.top="0px",this.domElement.style.left="0px",this.domElement.style.zIndex="-2",this},R.ArToolkitSource.prototype._initSourceWebcam=function(e,t){t=t||function(e){alert("Webcam Error\nName: "+e.name+"\nMessage: "+e.message)};var r=document.createElement("video");return r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.setAttribute("playsinline",""),r.style.width=this.parameters.displayWidth+"px",r.style.height=this.parameters.displayHeight+"px",navigator.mediaDevices.enumerateDevices().then((function(a){navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:{min:640,max:1920},height:{min:480,max:1080}}}).then((function(t){r.srcObject=t,document.body.addEventListener("click",(function(){return r.play()}));var a=setInterval((function(){r.videoWidth&&(e(),clearInterval(a))}),20)})).catch((function(e){t({name:e.name,message:e.message})}))})).catch((function(e){t({message:e.message})})),r},R.ArToolkitSource.prototype.onResizeElement=function(){var e=window.innerWidth,t=window.innerHeight,r=this.domElement.videoWidth/this.domElement.videoHeight;if(e/t<r){var a=r*t;this.domElement.style.width=a+"px",this.domElement.style.marginLeft=-(a-e)/2+"px",this.domElement.style.height=t+"px",this.domElement.style.marginTop="0px"}else{var n=1/(r/e);this.domElement.style.height=n+"px",this.domElement.style.marginTop=-(n-t)/2+"px",this.domElement.style.width=e+"px",this.domElement.style.marginLeft="0px"}},R.ArToolkitSource.prototype.copyElementSizeTo=function(e){e.style.width=this.domElement.style.width,e.style.height=this.domElement.style.height,e.style.marginLeft=this.domElement.style.marginLeft,e.style.marginTop=this.domElement.style.marginTop},window.THREEx=window.THREEx||{};var T=window,O=T.THREEx,j=T.artoolkit,H=T.ARController,I=T.ARCameraParam;O.ArToolkitContext=function(e){this.arController=null,this.arucoContext=null,this.initialized=!1,this._updatedAt=null,this._arMarkersControls=[],this.parameters=Object(x.a)({detectionMode:"mono",matrixCodeType:"3x3",cameraParametersUrl:"parameters/camera_para.dat",maxDetectionRate:60,canvasWidth:640,canvasHeight:480,patternRatio:.5,imageSmoothingEnabled:!1},e),console.assert(-1!==["color","color_and_matrix","mono","mono_and_matrix"].indexOf(this.parameters.detectionMode),"invalid parameter detectionMode",this.parameters.detectionMode)},Object.assign(O.ArToolkitContext.prototype,d.n.prototype),O.ArToolkitContext.prototype.init=function(e){var t=this;this._initArtoolkit((function(){t.dispatchEvent({type:"initialized"}),t.initialized=!0,e&&e()}))},O.ArToolkitContext.prototype.update=function(e){if(null===this.arController)return!1;var t=performance.now();return!(null!==this._updatedAt&&t-this._updatedAt<1e3/this.parameters.maxDetectionRate)&&(this._updatedAt=t,this._arMarkersControls.forEach((function(e){e.object3d.visible=!1})),this._updateArtoolkit(e),this.dispatchEvent({type:"sourceProcessed"}),!0)},O.ArToolkitContext.prototype.addMarker=function(e){console.assert(e instanceof O.ArMarkerControls),this._arMarkersControls.push(e)},O.ArToolkitContext.prototype.removeMarker=function(e){console.assert(e instanceof O.ArMarkerControls);var t=this._arMarkersControls.findIndex((function(t){return t.id===e.id}));this._arMarkersControls.splice(t,1)},O.ArToolkitContext.prototype._initArtoolkit=function(e){var t=this;this._artoolkitProjectionAxisTransformMatrix=new d.H,this._artoolkitProjectionAxisTransformMatrix.multiply((new d.H).makeRotationY(Math.PI)),this._artoolkitProjectionAxisTransformMatrix.multiply((new d.H).makeRotationZ(Math.PI));var r=new I(t.parameters.cameraParametersUrl,(function(){var a=new H(t.parameters.canvasWidth,t.parameters.canvasHeight,r);t.arController=a,a.ctx.mozImageSmoothingEnabled=t.parameters.imageSmoothingEnabled,a.ctx.webkitImageSmoothingEnabled=t.parameters.imageSmoothingEnabled,a.ctx.msImageSmoothingEnabled=t.parameters.imageSmoothingEnabled,a.ctx.imageSmoothingEnabled=t.parameters.imageSmoothingEnabled;var n={color:j.AR_TEMPLATE_MATCHING_COLOR,color_and_matrix:j.AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX,mono:j.AR_TEMPLATE_MATCHING_MONO,mono_and_matrix:j.AR_TEMPLATE_MATCHING_MONO_AND_MATRIX}[t.parameters.detectionMode];console.assert(void 0!==n),a.setPatternDetectionMode(n);var o={"3x3":j.AR_MATRIX_CODE_3x3,"3x3_HAMMING63":j.AR_MATRIX_CODE_3x3_HAMMING63,"3x3_PARITY65":j.AR_MATRIX_CODE_3x3_PARITY65,"4x4":j.AR_MATRIX_CODE_4x4,"4x4_BCH_13_9_3":j.AR_MATRIX_CODE_4x4_BCH_13_9_3,"4x4_BCH_13_5_5":j.AR_MATRIX_CODE_4x4_BCH_13_5_5}[t.parameters.matrixCodeType];console.assert(void 0!==o),a.setMatrixCodeType(o),a.setPattRatio(t.parameters.patternRatio),e()}));return this},O.ArToolkitContext.prototype.getProjectionMatrix=function(e){console.assert(this.arController,"arController MUST be initialized to call this function");var t=this.arController.getCameraMatrix(),r=(new d.H).fromArray(t);return r.multiply(this._artoolkitProjectionAxisTransformMatrix),r},O.ArToolkitContext.prototype._updateArtoolkit=function(e){this.arController.process(e)},window.THREEx=window.THREEx||{};var P=window.THREEx;P.ArBaseControls=function(e){this.id=P.ArBaseControls.id++,this.object3d=e,this.object3d.matrixAutoUpdate=!1,this.object3d.visible=!1},P.ArBaseControls.id=0,Object.assign(P.ArBaseControls.prototype,d.n.prototype),P.ArBaseControls.prototype.update=function(){console.assert(!1,"you need to implement your own update")},P.ArBaseControls.prototype.name=function(){return console.assert(!1,"you need to implement your own .name()"),"Not yet implemented - name()"},window.THREEx=window.THREEx||{};var S=window,N=S.artoolkit,L=S.THREEx;L.ArMarkerControls=function(e,t,r){var a=this;L.ArBaseControls.call(this,t),this.context=e,this.parameters={size:1,type:"unknown",patternUrl:null,barcodeValue:null,changeMatrixMode:"modelViewMatrix",minConfidence:.6};console.assert(-1!==["pattern","barcode","unknown"].indexOf(this.parameters.type),"illegal value",this.parameters.type);console.assert(-1!==["modelViewMatrix","cameraTransformMatrix"].indexOf(this.parameters.changeMatrixMode),"illegal value",this.parameters.changeMatrixMode),this.object3d=t,this.object3d.matrixAutoUpdate=!1,this.object3d.visible=!1,function(e){if(void 0===e)return;for(var t in e){var r=e[t];if(void 0!==r)void 0!==a.parameters[t]?a.parameters[t]=r:console.warn("THREEx.ArMarkerControls: '"+t+"' is not a property of this material.");else console.warn("THREEx.ArMarkerControls: '"+t+"' parameter is undefined.")}}(r),e.addMarker(this),this._initArtoolkit()},L.ArMarkerControls.prototype=Object.create(L.ArBaseControls.prototype),L.ArMarkerControls.prototype.dispose=function(){this.context.removeMarker(this)},L.ArMarkerControls.prototype.updateWithModelViewMatrix=function(e){var t=this.object3d;t.visible=!0;var r=(new d.H).copy(this.context._artoolkitProjectionAxisTransformMatrix),a=(new d.H).makeRotationX(Math.PI/2);r.multiply(e),r.multiply(a),e.copy(r),"modelViewMatrix"===this.parameters.changeMatrixMode?t.matrix.copy(e):"cameraTransformMatrix"===this.parameters.changeMatrixMode?t.matrix.getInverse(e):console.assert(!1),t.matrix.decompose(t.position,t.quaternion,t.scale),this.dispatchEvent({type:"markerPositionUpdated",data:t.matrix.toArray()})},L.ArMarkerControls.prototype.name=function(){var e="";(e+=this.parameters.type,"pattern"===this.parameters.type)?e+=" - "+this.parameters.patternUrl.replace(/^.*\//g,""):"barcode"===this.parameters.type?e+=" - "+this.parameters.barcodeValue:console.assert(!1,"no .name() implemented for this marker controls");return e},L.ArMarkerControls.prototype._initArtoolkit=function(){var e=this,t=null,r=setInterval((function(){console.log(e.context.arController),null!==e.context.arController&&(clearInterval(r),r=null,function(){var r=e.context.arController;console.assert(null!==r),"pattern"===e.parameters.type?r.loadMarker(e.parameters.patternUrl,(function(a){t=a,r.trackPatternMarkerId(t,e.parameters.size)})):"barcode"===e.parameters.type?(t=e.parameters.barcodeValue,r.trackBarcodeMarkerId(t,e.parameters.size)):"unknown"===e.parameters.type?t=null:console.log(!1,"invalid marker type",e.parameters.type);r.addEventListener("getMarker",(function(r){if(r.data.type===N.PATTERN_MARKER&&"pattern"===e.parameters.type){if(null===t)return;r.data.marker.idPatt===t&&a(r)}else if(r.data.type===N.BARCODE_MARKER&&"barcode"===e.parameters.type){if(null===t)return;r.data.marker.idMatrix===t&&a(r)}else r.data.type===N.UNKNOWN_MARKER&&"unknown"===e.parameters.type&&a(r)}))}())}),20);return;function a(t){if(!(t.data.type===N.PATTERN_MARKER&&t.data.marker.cfPatt<e.parameters.minConfidence)&&!(t.data.type===N.BARCODE_MARKER&&t.data.marker.cfMatt<e.parameters.minConfidence)){var r=(new d.H).fromArray(t.data.matrix);e.updateWithModelViewMatrix(r)}}};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(31);i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.8c84f4cb.chunk.js.map